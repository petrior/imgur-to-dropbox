function App(){	// Variables.	var returnData;	var images = [];	var currentUrl;	var currentPic = 0;	var currentSelectedPic = 0;	var searchString;	var searchPage = 0;		// DOM-elements.	var randomPic = $('#randomPic');	var previousPic = $('#previousPic');	var nextPic = $('#nextPic');	var imageContainer = $('#imageContainer');	var searchBtn = $('#searchBtn');	var searchText = $('#searchText');	var buttons = $('#buttons');	var loading = $('#loading');	var currentImg = $('#currentImg');	var totalImages = $('#totalImages');	var loadM = $('#loadMore');	var error = $('#error');	var selectedImages = $('#selectedImages');	var showSelected = $('#showSelected');	var selectedContainer = $('#selectedContainer');	var viewAll = $('#viewAll');	var toggleResults = $('#toggleResults');	var allPictures = $('#allPictures');	var selected = $('#selected');	var previousSel = $('#previousSelected');	var nextSel = $('#nextSelected');	var cSelectedPic = $('#cSelectedPic');	var cSelectedTotal = $('#cSelectedTotal');	var loadingMain = $('#loadingMain');		// Show zero images selected on page load.	selectedImages.text(" (" + images.length + ")");	currentImg.text(" 0 ");	totalImages.text(" 0 ");	cSelectedPic.text(" 0 ");	cSelectedTotal.text(" 0 ");		// EventListeners.	randomPic.click(randomPicture);	previousPic.click(previousPicture);	nextPic.click(nextPicture);	searchBtn.click(search);	loadM.click(loadMore);	showSelected.click(showSelectedImages);	toggleResults.click(showResults);	previousSel.click(previousSelected);	nextSel.click(nextSelected);		// Loading animation.	$(document)		.ajaxStart(function(){			loading.show();		})		.ajaxStop(function(){			loading.hide();		});		function search()	{		searchString = searchText.val();		if(searchString != null && searchString != "")			getImgurImages();	}		function loadMore()	{		searchPage++;				if(error.is(':empty'))		{			error.text("");						$.ajax({					url: 'https://api.imgur.com/3/gallery/search/viral/'+searchPage+'?q=' + searchString,					method: 'GET',					headers: {						Authorization:'Client-ID 08f0b01689a3b81',						Accept:'application/json'					},					success: function(data){						if(data.data.length == 0)						{							error.text("No more results...");						} else						{							for(var i = 0; i<data.data.length; i++)							{								returnData.data.push(data.data[i]);							}							totalImages.text(" " + returnData.data.length + ".");						}					},					error: function(response){						var text = $('<p>');						text.text(response.statusText);						buttons.append(text);					}				});		}	}		// Get data from imgur.	function getImgurImages()	{		error.text("");		imageContainer.empty();		searchPage = 0;				loadingMain.show();		loadingMain.css("display", "block");				$.ajax({				url: 'https://api.imgur.com/3/gallery/search/viral/0?q=' + searchString,				method: 'GET',				headers: {					Authorization:'Client-ID 08f0b01689a3b81',					Accept:'application/json'				},				success: function(data){					returnData = data;					currentPic = 0;					loadingMain.hide();										if(data.data.length == 0)					{						var text = $('<p>');						text.text("No results...");						text.css("color", "#fff");						text.css("text-align", "center");						imageContainer.append(text);						allPictures.show();					}					else					{						changePicture();						allPictures.show();						selected.hide();					}				},				error: function(response){					var text = $('<p>');					text.text(response.statusText);					imageContainer.append(text);					loadingMain.hide();					allPictures.show();				},			});	}		function previousPicture()	{		if(returnData !== undefined)		{			if(currentPic > 0)				currentPic--;			else				currentPic = returnData.data.length - 1;							changePicture();		}	}		function nextPicture()	{		if(returnData !== undefined)		{			if(currentPic < returnData.data.length - 1)				currentPic++;			else				currentPic = 0;							changePicture();		}	}		function randomPicture()	{		if(returnData !== undefined)		{			var random;			do {				random = Math.floor(Math.random() * (returnData.data.length - 1));			} while (random == currentPic);			currentPic = random;			changePicture();		}	}		function changePicture()	{		imageContainer.empty();				var image = $('<img>');				if(returnData.data[currentPic].cover === undefined)		{			image.attr("src", returnData.data[currentPic].link);			currentUrl = returnData.data[currentPic].link;		}		else{			currentUrl = "http://imgur.com/" + returnData.data[currentPic].cover + ".jpg";			image.attr("src", currentUrl);		}				for(var i = 0; i < images.length; i++)		{			if(images[i].url == image.attr("src"))				image.attr("class", "selected");		}				currentImg.text(" " + (currentPic + 1) + " ");		totalImages.text(" " + returnData.data.length);				image.attr("onclick", "app.addImage(this);");		imageContainer.append(image);	}		this.addImage = function(img)	{		var image = $(img);				var imageSelected = false;				for(var i=0; i<images.length; i++)		{			if(images[i].url == image.attr("src"))				imageSelected = i;		}				if(imageSelected === false)		{			images.push({'url':image.attr("src"), 'filename':image.attr("src").substring(image.attr("src").lastIndexOf("/") + 1, image.attr("src").length)});			image.attr("class", "selected");		}		else		{			images.splice(imageSelected, 1);			if(imageSelected == currentSelectedPic)				currentSelectedPic--;			image.attr("class", "");			selected.hide();		}				selectedImages.text(" (" + images.length + ")");	}		function addDropboxBtn()	{		if(images.length > 0)		{			$('#asdf').remove();			var options = {				files: images,				success: function () {images = []; selected.hide(); selectedImages.text(" (" + images.length + ")");}				};						var button = Dropbox.createSaveButton(options);			button = $(button);			button.attr("id", "asdf");			selectedContainer.append(button);		}	}		this.checkEnter = function(event)	{		if(event.keyCode == 13)			search();	}		function showSelectedImages(event)	{		event.preventDefault();				if(images.length > 0)		{			changeSelected();						allPictures.hide();			selected.toggle();		}	}		function showResults(event)	{		event.preventDefault();				if(allPictures.css("display") == "none")		{			if(returnData !== undefined)				changePicture();			allPictures.show();			$(window).scrollTop(allPictures.offset().top);			selected.hide();		}		else		{			allPictures.hide();		}	}		function previousSelected()	{		if(images.length > 0)		{			if(currentSelectedPic > 0)				currentSelectedPic--;			else				currentSelectedPic = images.length - 1;							changeSelected();		}	}		function nextSelected()	{		if(images.length > 0)		{			if(currentSelectedPic < images.length - 1)				currentSelectedPic++;			else				currentSelectedPic = 0;						changeSelected();		}	}		function changeSelected()	{		selectedContainer.empty();					addDropboxBtn();				var img = $('<img>');		img.attr("src", images[currentSelectedPic].url);		img.attr("onclick", "app.removeImage();");		selectedContainer.append(img);				cSelectedPic.text(" " + (currentSelectedPic+1) + " ");		cSelectedTotal.text(" " + images.length + " ");	}		this.removeImage = function()	{		images.splice(currentSelectedPic, 1);		selectedImages.text(" (" + images.length + ")");				if(images.length == 0)		{			selected.hide();			currentSelectedPic = 0;		}		else if(currentSelectedPic > 0)		{			currentSelectedPic--;			changeSelected();		} else		{			changeSelected();		}	}}